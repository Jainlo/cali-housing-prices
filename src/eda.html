<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.242">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>eda</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="eda_files/libs/clipboard/clipboard.min.js"></script>
<script src="eda_files/libs/quarto-html/quarto.js"></script>
<script src="eda_files/libs/quarto-html/popper.min.js"></script>
<script src="eda_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="eda_files/libs/quarto-html/anchor.min.js"></script>
<link href="eda_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="eda_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="eda_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="eda_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="eda_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="california-housing-prices---regression" class="level1">
<h1>California Housing Prices - Regression</h1>
<p>In this assignment we applied regression models to predict housing prices ### Features: - longitude: A measure of how far west a house is; a higher value is farther west - latitude: A measure of how far north a house is; a higher value is farther north - housing_median_age: Median age of a house within a block; a lower number is a newer building - total_rooms: Total number of rooms within a block - total_bedrooms: Total number of bedrooms within a block - population: Total number of people residing within a block - households: Total number of households, a group of people residing within a home unit, for a block - median_income: Median income for households within a block of houses (measured in tens of thousands of US Dollars) - ocean_proximity: Location of the house w.r.t ocean/sea ### Target variable: median_house_value: Median house value for households within a block (measured in US Dollars) # Feature Engineering and Selection ## Prerequisite</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># helper packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> missingno <span class="im">as</span> msno</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> VarianceThreshold</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> TransformedTargetRegressor</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> make_column_selector <span class="im">as</span> selector</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PowerTransformer</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> VarianceThreshold</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> SelectKBest, f_regression</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> mutual_info_regression</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="cali-dataset" class="level2">
<h2 class="anchored" data-anchor-id="cali-dataset">Cali dataset</h2>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read california housing dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>cali <span class="op">=</span> pd.read_csv(<span class="st">"../data/housing.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># show dimensions</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>cali.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>(20640, 10)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show data types and other details in the dataset</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>cali.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 20640 entries, 0 to 20639
Data columns (total 10 columns):
 #   Column              Non-Null Count  Dtype  
---  ------              --------------  -----  
 0   longitude           20640 non-null  float64
 1   latitude            20640 non-null  float64
 2   housing_median_age  20640 non-null  float64
 3   total_rooms         20640 non-null  float64
 4   total_bedrooms      20433 non-null  float64
 5   population          20640 non-null  float64
 6   households          20640 non-null  float64
 7   median_income       20640 non-null  float64
 8   median_house_value  20640 non-null  float64
 9   ocean_proximity     20640 non-null  object 
dtypes: float64(9), object(1)
memory usage: 1.6+ MB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show 20 random rows</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>cali.sample(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>housing_median_age</th>
      <th>total_rooms</th>
      <th>total_bedrooms</th>
      <th>population</th>
      <th>households</th>
      <th>median_income</th>
      <th>median_house_value</th>
      <th>ocean_proximity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11525</th>
      <td>-118.05</td>
      <td>33.72</td>
      <td>22.0</td>
      <td>5416.0</td>
      <td>1271.0</td>
      <td>2260.0</td>
      <td>1184.0</td>
      <td>3.8038</td>
      <td>174500.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>5015</th>
      <td>-118.32</td>
      <td>34.00</td>
      <td>50.0</td>
      <td>2189.0</td>
      <td>460.0</td>
      <td>1097.0</td>
      <td>469.0</td>
      <td>2.4583</td>
      <td>120900.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>18391</th>
      <td>-121.87</td>
      <td>37.27</td>
      <td>16.0</td>
      <td>3298.0</td>
      <td>451.0</td>
      <td>1542.0</td>
      <td>423.0</td>
      <td>6.7064</td>
      <td>305600.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>13091</th>
      <td>-121.35</td>
      <td>38.56</td>
      <td>16.0</td>
      <td>2278.0</td>
      <td>370.0</td>
      <td>1203.0</td>
      <td>371.0</td>
      <td>5.0622</td>
      <td>132400.0</td>
      <td>INLAND</td>
    </tr>
    <tr>
      <th>4912</th>
      <td>-118.27</td>
      <td>34.01</td>
      <td>47.0</td>
      <td>921.0</td>
      <td>264.0</td>
      <td>881.0</td>
      <td>221.0</td>
      <td>1.4327</td>
      <td>114100.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>8886</th>
      <td>-118.51</td>
      <td>34.03</td>
      <td>37.0</td>
      <td>4072.0</td>
      <td>905.0</td>
      <td>1468.0</td>
      <td>923.0</td>
      <td>3.8571</td>
      <td>500001.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>19980</th>
      <td>-119.08</td>
      <td>36.20</td>
      <td>30.0</td>
      <td>1677.0</td>
      <td>358.0</td>
      <td>1159.0</td>
      <td>365.0</td>
      <td>2.4554</td>
      <td>61200.0</td>
      <td>INLAND</td>
    </tr>
    <tr>
      <th>1476</th>
      <td>-122.04</td>
      <td>37.96</td>
      <td>16.0</td>
      <td>2913.0</td>
      <td>723.0</td>
      <td>1705.0</td>
      <td>693.0</td>
      <td>2.9097</td>
      <td>106300.0</td>
      <td>NEAR BAY</td>
    </tr>
    <tr>
      <th>12766</th>
      <td>-121.42</td>
      <td>38.62</td>
      <td>33.0</td>
      <td>3171.0</td>
      <td>832.0</td>
      <td>1591.0</td>
      <td>695.0</td>
      <td>2.0786</td>
      <td>88600.0</td>
      <td>INLAND</td>
    </tr>
    <tr>
      <th>14294</th>
      <td>-117.13</td>
      <td>32.72</td>
      <td>43.0</td>
      <td>2160.0</td>
      <td>504.0</td>
      <td>1221.0</td>
      <td>452.0</td>
      <td>2.4821</td>
      <td>140600.0</td>
      <td>NEAR OCEAN</td>
    </tr>
    <tr>
      <th>4946</th>
      <td>-118.30</td>
      <td>34.02</td>
      <td>27.0</td>
      <td>2190.0</td>
      <td>626.0</td>
      <td>1768.0</td>
      <td>528.0</td>
      <td>1.2446</td>
      <td>103800.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>4593</th>
      <td>-118.27</td>
      <td>34.05</td>
      <td>26.0</td>
      <td>1164.0</td>
      <td>674.0</td>
      <td>1685.0</td>
      <td>541.0</td>
      <td>1.5727</td>
      <td>225000.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>11233</th>
      <td>-117.96</td>
      <td>33.82</td>
      <td>32.0</td>
      <td>2726.0</td>
      <td>556.0</td>
      <td>1513.0</td>
      <td>531.0</td>
      <td>3.7917</td>
      <td>197400.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>16104</th>
      <td>-122.50</td>
      <td>37.75</td>
      <td>45.0</td>
      <td>1620.0</td>
      <td>NaN</td>
      <td>941.0</td>
      <td>328.0</td>
      <td>4.3859</td>
      <td>270200.0</td>
      <td>NEAR OCEAN</td>
    </tr>
    <tr>
      <th>9047</th>
      <td>-118.09</td>
      <td>34.71</td>
      <td>5.0</td>
      <td>5807.0</td>
      <td>1182.0</td>
      <td>2602.0</td>
      <td>1007.0</td>
      <td>2.4012</td>
      <td>159400.0</td>
      <td>INLAND</td>
    </tr>
    <tr>
      <th>14731</th>
      <td>-117.02</td>
      <td>32.81</td>
      <td>27.0</td>
      <td>1950.0</td>
      <td>317.0</td>
      <td>950.0</td>
      <td>320.0</td>
      <td>4.0656</td>
      <td>164000.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>11664</th>
      <td>-118.03</td>
      <td>33.85</td>
      <td>30.0</td>
      <td>2320.0</td>
      <td>448.0</td>
      <td>1434.0</td>
      <td>452.0</td>
      <td>4.0865</td>
      <td>203700.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>16376</th>
      <td>-121.29</td>
      <td>38.03</td>
      <td>7.0</td>
      <td>2021.0</td>
      <td>441.0</td>
      <td>1615.0</td>
      <td>406.0</td>
      <td>2.5842</td>
      <td>111300.0</td>
      <td>INLAND</td>
    </tr>
    <tr>
      <th>3568</th>
      <td>-118.58</td>
      <td>34.23</td>
      <td>35.0</td>
      <td>1917.0</td>
      <td>314.0</td>
      <td>1019.0</td>
      <td>340.0</td>
      <td>4.8929</td>
      <td>234900.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>2446</th>
      <td>-119.61</td>
      <td>36.56</td>
      <td>34.0</td>
      <td>1911.0</td>
      <td>497.0</td>
      <td>1886.0</td>
      <td>481.0</td>
      <td>1.6250</td>
      <td>53000.0</td>
      <td>INLAND</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many null values do we have</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>cali.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>longitude               0
latitude                0
housing_median_age      0
total_rooms             0
total_bedrooms        207
population              0
households              0
median_income           0
median_house_value      0
ocean_proximity         0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many duplicated rows do we have</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cali.duplicated().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># statistical description of the dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>cali.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>housing_median_age</th>
      <th>total_rooms</th>
      <th>total_bedrooms</th>
      <th>population</th>
      <th>households</th>
      <th>median_income</th>
      <th>median_house_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20640.000000</td>
      <td>20640.000000</td>
      <td>20640.000000</td>
      <td>20640.000000</td>
      <td>20433.000000</td>
      <td>20640.000000</td>
      <td>20640.000000</td>
      <td>20640.000000</td>
      <td>20640.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-119.569704</td>
      <td>35.631861</td>
      <td>28.639486</td>
      <td>2635.763081</td>
      <td>537.870553</td>
      <td>1425.476744</td>
      <td>499.539680</td>
      <td>3.870671</td>
      <td>206855.816909</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.003532</td>
      <td>2.135952</td>
      <td>12.585558</td>
      <td>2181.615252</td>
      <td>421.385070</td>
      <td>1132.462122</td>
      <td>382.329753</td>
      <td>1.899822</td>
      <td>115395.615874</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-124.350000</td>
      <td>32.540000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>0.499900</td>
      <td>14999.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-121.800000</td>
      <td>33.930000</td>
      <td>18.000000</td>
      <td>1447.750000</td>
      <td>296.000000</td>
      <td>787.000000</td>
      <td>280.000000</td>
      <td>2.563400</td>
      <td>119600.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-118.490000</td>
      <td>34.260000</td>
      <td>29.000000</td>
      <td>2127.000000</td>
      <td>435.000000</td>
      <td>1166.000000</td>
      <td>409.000000</td>
      <td>3.534800</td>
      <td>179700.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>-118.010000</td>
      <td>37.710000</td>
      <td>37.000000</td>
      <td>3148.000000</td>
      <td>647.000000</td>
      <td>1725.000000</td>
      <td>605.000000</td>
      <td>4.743250</td>
      <td>264725.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>-114.310000</td>
      <td>41.950000</td>
      <td>52.000000</td>
      <td>39320.000000</td>
      <td>6445.000000</td>
      <td>35682.000000</td>
      <td>6082.000000</td>
      <td>15.000100</td>
      <td>500001.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation between features</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>cali.corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>housing_median_age</th>
      <th>total_rooms</th>
      <th>total_bedrooms</th>
      <th>population</th>
      <th>households</th>
      <th>median_income</th>
      <th>median_house_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>longitude</th>
      <td>1.000000</td>
      <td>-0.924664</td>
      <td>-0.108197</td>
      <td>0.044568</td>
      <td>0.069608</td>
      <td>0.099773</td>
      <td>0.055310</td>
      <td>-0.015176</td>
      <td>-0.045967</td>
    </tr>
    <tr>
      <th>latitude</th>
      <td>-0.924664</td>
      <td>1.000000</td>
      <td>0.011173</td>
      <td>-0.036100</td>
      <td>-0.066983</td>
      <td>-0.108785</td>
      <td>-0.071035</td>
      <td>-0.079809</td>
      <td>-0.144160</td>
    </tr>
    <tr>
      <th>housing_median_age</th>
      <td>-0.108197</td>
      <td>0.011173</td>
      <td>1.000000</td>
      <td>-0.361262</td>
      <td>-0.320451</td>
      <td>-0.296244</td>
      <td>-0.302916</td>
      <td>-0.119034</td>
      <td>0.105623</td>
    </tr>
    <tr>
      <th>total_rooms</th>
      <td>0.044568</td>
      <td>-0.036100</td>
      <td>-0.361262</td>
      <td>1.000000</td>
      <td>0.930380</td>
      <td>0.857126</td>
      <td>0.918484</td>
      <td>0.198050</td>
      <td>0.134153</td>
    </tr>
    <tr>
      <th>total_bedrooms</th>
      <td>0.069608</td>
      <td>-0.066983</td>
      <td>-0.320451</td>
      <td>0.930380</td>
      <td>1.000000</td>
      <td>0.877747</td>
      <td>0.979728</td>
      <td>-0.007723</td>
      <td>0.049686</td>
    </tr>
    <tr>
      <th>population</th>
      <td>0.099773</td>
      <td>-0.108785</td>
      <td>-0.296244</td>
      <td>0.857126</td>
      <td>0.877747</td>
      <td>1.000000</td>
      <td>0.907222</td>
      <td>0.004834</td>
      <td>-0.024650</td>
    </tr>
    <tr>
      <th>households</th>
      <td>0.055310</td>
      <td>-0.071035</td>
      <td>-0.302916</td>
      <td>0.918484</td>
      <td>0.979728</td>
      <td>0.907222</td>
      <td>1.000000</td>
      <td>0.013033</td>
      <td>0.065843</td>
    </tr>
    <tr>
      <th>median_income</th>
      <td>-0.015176</td>
      <td>-0.079809</td>
      <td>-0.119034</td>
      <td>0.198050</td>
      <td>-0.007723</td>
      <td>0.004834</td>
      <td>0.013033</td>
      <td>1.000000</td>
      <td>0.688075</td>
    </tr>
    <tr>
      <th>median_house_value</th>
      <td>-0.045967</td>
      <td>-0.144160</td>
      <td>0.105623</td>
      <td>0.134153</td>
      <td>0.049686</td>
      <td>-0.024650</td>
      <td>0.065843</td>
      <td>0.688075</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">10</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cali.corr(),cmap<span class="op">=</span><span class="st">'mako'</span>, annot<span class="op">=</span><span class="va">True</span>, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="eda_files/figure-html/cell-10-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="check-for-non-informative-predictors" class="level2">
<h2 class="anchored" data-anchor-id="check-for-non-informative-predictors">Check for non-informative predictors</h2>
<section id="feature-variance" class="level3">
<h3 class="anchored" data-anchor-id="feature-variance">Feature variance</h3>
<p>After testing for feature variace, we could see that there were no constant features, so none were deleted</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> cali.drop(<span class="st">'median_house_value'</span>,axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># remove low variance features</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>var_thres <span class="op">=</span> VarianceThreshold(threshold<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># exception for categorical features</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>var_thres.fit(X.drop(<span class="st">"ocean_proximity"</span>, axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># shows which column is non constant (True)</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>var_thres.get_support()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>array([ True,  True,  True,  True,  True,  True,  True,  True])</code></pre>
</div>
</div>
</section>
<section id="check-for-imbalanced-distributions" class="level3">
<h3 class="anchored" data-anchor-id="check-for-imbalanced-distributions">Check for imbalanced distributions</h3>
<p>Check for factor variable where some levels are very common while others very rare. After using value counts on ocean proximity feature, we can see that ‘NEAR OCEAN’, ‘NEAR BAY’ and ‘ISLAND’ have way lower value counts, in this case we can use Lumping to group them together into one category called ‘OTHER’</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># before lumping</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>cali[<span class="st">"ocean_proximity"</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>&lt;1H OCEAN     9136
INLAND        6551
NEAR OCEAN    2658
NEAR BAY      2290
ISLAND           5
Name: ocean_proximity, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace values 'near ocean' 'near bay' and 'island' with 'other'</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cali[<span class="st">"ocean_proximity"</span>] <span class="op">=</span> cali[<span class="st">"ocean_proximity"</span>].replace([<span class="st">'NEAR OCEAN'</span>, <span class="st">'NEAR BAY'</span>, <span class="st">'ISLAND'</span>], <span class="st">'OTHER'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># after lumping</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>cali[<span class="st">"ocean_proximity"</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>&lt;1H OCEAN    9136
INLAND       6551
OTHER        4953
Name: ocean_proximity, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># features</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>cali2 <span class="op">=</span> cali.dropna()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> cali2.drop(<span class="st">"median_house_value"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> pd.get_dummies(data<span class="op">=</span>features ,drop_first<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># target variable</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> cali2[<span class="st">"median_house_value"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sm.OLS(target,features)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>fit <span class="op">=</span> model.fit()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>fit.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>    <td>median_house_value</td> <th>  R-squared (uncentered):</th>       <td>   0.913</td>  
</tr>
<tr>
  <th>Model:</th>                    <td>OLS</td>        <th>  Adj. R-squared (uncentered):</th>  <td>   0.913</td>  
</tr>
<tr>
  <th>Method:</th>              <td>Least Squares</td>   <th>  F-statistic:       </th>           <td>2.148e+04</td> 
</tr>
<tr>
  <th>Date:</th>              <td>Tue, 29 Nov 2022</td>  <th>  Prob (F-statistic):</th>            <td>  0.00</td>   
</tr>
<tr>
  <th>Time:</th>                  <td>03:12:21</td>      <th>  Log-Likelihood:    </th>          <td>-2.5689e+05</td>
</tr>
<tr>
  <th>No. Observations:</th>       <td> 20433</td>       <th>  AIC:               </th>           <td>5.138e+05</td> 
</tr>
<tr>
  <th>Df Residuals:</th>           <td> 20423</td>       <th>  BIC:               </th>           <td>5.139e+05</td> 
</tr>
<tr>
  <th>Df Model:</th>               <td>    10</td>       <th>                     </th>               <td> </td>     
</tr>
<tr>
  <th>Covariance Type:</th>       <td>nonrobust</td>     <th>                     </th>               <td> </td>     
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
             <td></td>               <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>longitude</th>              <td> -832.4694</td> <td>  108.194</td> <td>   -7.694</td> <td> 0.000</td> <td>-1044.539</td> <td> -620.400</td>
</tr>
<tr>
  <th>latitude</th>               <td>-2006.4645</td> <td>  358.566</td> <td>   -5.596</td> <td> 0.000</td> <td>-2709.282</td> <td>-1303.647</td>
</tr>
<tr>
  <th>housing_median_age</th>     <td> 1138.2147</td> <td>   43.786</td> <td>   25.995</td> <td> 0.000</td> <td> 1052.391</td> <td> 1224.038</td>
</tr>
<tr>
  <th>total_rooms</th>            <td>   -7.0507</td> <td>    0.804</td> <td>   -8.770</td> <td> 0.000</td> <td>   -8.627</td> <td>   -5.475</td>
</tr>
<tr>
  <th>total_bedrooms</th>         <td>   79.1725</td> <td>    6.930</td> <td>   11.425</td> <td> 0.000</td> <td>   65.590</td> <td>   92.755</td>
</tr>
<tr>
  <th>population</th>             <td>  -37.5053</td> <td>    1.094</td> <td>  -34.276</td> <td> 0.000</td> <td>  -39.650</td> <td>  -35.360</td>
</tr>
<tr>
  <th>households</th>             <td>   76.9152</td> <td>    7.493</td> <td>   10.266</td> <td> 0.000</td> <td>   62.229</td> <td>   91.601</td>
</tr>
<tr>
  <th>median_income</th>          <td> 4.016e+04</td> <td>  341.045</td> <td>  117.747</td> <td> 0.000</td> <td> 3.95e+04</td> <td> 4.08e+04</td>
</tr>
<tr>
  <th>ocean_proximity_INLAND</th> <td>-6.524e+04</td> <td> 1411.194</td> <td>  -46.228</td> <td> 0.000</td> <td> -6.8e+04</td> <td>-6.25e+04</td>
</tr>
<tr>
  <th>ocean_proximity_OTHER</th>  <td> 1.091e+04</td> <td> 1311.875</td> <td>    8.316</td> <td> 0.000</td> <td> 8338.268</td> <td> 1.35e+04</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
  <th>Omnibus:</th>       <td>4884.909</td> <th>  Durbin-Watson:     </th> <td>   0.966</td> 
</tr>
<tr>
  <th>Prob(Omnibus):</th>  <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>17247.520</td>
</tr>
<tr>
  <th>Skew:</th>           <td> 1.180</td>  <th>  Prob(JB):          </th> <td>    0.00</td> 
</tr>
<tr>
  <th>Kurtosis:</th>       <td> 6.832</td>  <th>  Cond. No.          </th> <td>1.32e+04</td> 
</tr>
</tbody></table><br><br>Notes:<br>[1] R² is computed without centering (uncentered) since the model does not contain a constant.<br>[2] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br>[3] The condition number is large, 1.32e+04. This might indicate that there are<br>strong multicollinearity or other numerical problems.
</div>
</div>
</section>
</section>
<section id="check-for-missingness" class="level2">
<h2 class="anchored" data-anchor-id="check-for-missingness">Check for missingness</h2>
<p>Reason for missingness: from the mask it seems that values are missing at random.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>msno.matrix(X, labels<span class="op">=</span><span class="va">True</span>, <span class="bu">filter</span><span class="op">=</span><span class="st">"bottom"</span>, sort<span class="op">=</span><span class="st">"ascending"</span>, n<span class="op">=</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="eda_files/figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>cali[cali[<span class="st">'total_bedrooms'</span>].isna()].sample(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>housing_median_age</th>
      <th>total_rooms</th>
      <th>total_bedrooms</th>
      <th>population</th>
      <th>households</th>
      <th>median_income</th>
      <th>median_house_value</th>
      <th>ocean_proximity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19833</th>
      <td>-119.38</td>
      <td>36.53</td>
      <td>38.0</td>
      <td>1281.0</td>
      <td>NaN</td>
      <td>1423.0</td>
      <td>293.0</td>
      <td>1.9602</td>
      <td>51400.0</td>
      <td>INLAND</td>
    </tr>
    <tr>
      <th>18246</th>
      <td>-122.08</td>
      <td>37.39</td>
      <td>4.0</td>
      <td>2292.0</td>
      <td>NaN</td>
      <td>1050.0</td>
      <td>584.0</td>
      <td>4.8036</td>
      <td>340000.0</td>
      <td>OTHER</td>
    </tr>
    <tr>
      <th>15607</th>
      <td>-116.66</td>
      <td>32.79</td>
      <td>13.0</td>
      <td>843.0</td>
      <td>NaN</td>
      <td>918.0</td>
      <td>152.0</td>
      <td>6.2152</td>
      <td>240600.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>19559</th>
      <td>-120.98</td>
      <td>37.60</td>
      <td>36.0</td>
      <td>1437.0</td>
      <td>NaN</td>
      <td>1073.0</td>
      <td>320.0</td>
      <td>2.1779</td>
      <td>58400.0</td>
      <td>INLAND</td>
    </tr>
    <tr>
      <th>14970</th>
      <td>-117.01</td>
      <td>32.74</td>
      <td>31.0</td>
      <td>3473.0</td>
      <td>NaN</td>
      <td>2098.0</td>
      <td>677.0</td>
      <td>2.6973</td>
      <td>135200.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>20267</th>
      <td>-119.19</td>
      <td>34.20</td>
      <td>18.0</td>
      <td>3620.0</td>
      <td>NaN</td>
      <td>3171.0</td>
      <td>779.0</td>
      <td>3.3409</td>
      <td>220500.0</td>
      <td>OTHER</td>
    </tr>
    <tr>
      <th>14386</th>
      <td>-117.23</td>
      <td>32.75</td>
      <td>5.0</td>
      <td>1824.0</td>
      <td>NaN</td>
      <td>892.0</td>
      <td>426.0</td>
      <td>3.4286</td>
      <td>137500.0</td>
      <td>OTHER</td>
    </tr>
    <tr>
      <th>4309</th>
      <td>-118.32</td>
      <td>34.09</td>
      <td>44.0</td>
      <td>2666.0</td>
      <td>NaN</td>
      <td>2297.0</td>
      <td>726.0</td>
      <td>1.6760</td>
      <td>208800.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>4591</th>
      <td>-118.28</td>
      <td>34.06</td>
      <td>42.0</td>
      <td>2472.0</td>
      <td>NaN</td>
      <td>3795.0</td>
      <td>1179.0</td>
      <td>1.2254</td>
      <td>162500.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>11351</th>
      <td>-117.91</td>
      <td>33.76</td>
      <td>20.0</td>
      <td>4413.0</td>
      <td>NaN</td>
      <td>4818.0</td>
      <td>1063.0</td>
      <td>2.8594</td>
      <td>215100.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>2351</th>
      <td>-119.68</td>
      <td>36.79</td>
      <td>16.0</td>
      <td>1551.0</td>
      <td>NaN</td>
      <td>1010.0</td>
      <td>292.0</td>
      <td>3.5417</td>
      <td>71300.0</td>
      <td>INLAND</td>
    </tr>
    <tr>
      <th>11096</th>
      <td>-117.87</td>
      <td>33.83</td>
      <td>27.0</td>
      <td>2287.0</td>
      <td>NaN</td>
      <td>1140.0</td>
      <td>351.0</td>
      <td>5.6163</td>
      <td>231000.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>5216</th>
      <td>-118.25</td>
      <td>33.94</td>
      <td>43.0</td>
      <td>793.0</td>
      <td>NaN</td>
      <td>736.0</td>
      <td>231.0</td>
      <td>0.8527</td>
      <td>90400.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>7763</th>
      <td>-118.10</td>
      <td>33.91</td>
      <td>36.0</td>
      <td>726.0</td>
      <td>NaN</td>
      <td>490.0</td>
      <td>130.0</td>
      <td>3.6389</td>
      <td>167600.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>19122</th>
      <td>-122.65</td>
      <td>38.25</td>
      <td>23.0</td>
      <td>4030.0</td>
      <td>NaN</td>
      <td>1852.0</td>
      <td>778.0</td>
      <td>3.4020</td>
      <td>193300.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>4744</th>
      <td>-118.36</td>
      <td>34.05</td>
      <td>45.0</td>
      <td>2283.0</td>
      <td>NaN</td>
      <td>1093.0</td>
      <td>475.0</td>
      <td>2.5658</td>
      <td>252000.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>20460</th>
      <td>-118.75</td>
      <td>34.29</td>
      <td>17.0</td>
      <td>5512.0</td>
      <td>NaN</td>
      <td>2734.0</td>
      <td>814.0</td>
      <td>6.6073</td>
      <td>258100.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
    <tr>
      <th>15663</th>
      <td>-122.44</td>
      <td>37.80</td>
      <td>52.0</td>
      <td>3830.0</td>
      <td>NaN</td>
      <td>1310.0</td>
      <td>963.0</td>
      <td>3.4801</td>
      <td>500001.0</td>
      <td>OTHER</td>
    </tr>
    <tr>
      <th>9622</th>
      <td>-120.32</td>
      <td>37.29</td>
      <td>38.0</td>
      <td>576.0</td>
      <td>NaN</td>
      <td>478.0</td>
      <td>112.0</td>
      <td>2.3382</td>
      <td>59600.0</td>
      <td>INLAND</td>
    </tr>
    <tr>
      <th>20484</th>
      <td>-118.72</td>
      <td>34.28</td>
      <td>17.0</td>
      <td>3051.0</td>
      <td>NaN</td>
      <td>1705.0</td>
      <td>495.0</td>
      <td>5.7376</td>
      <td>218600.0</td>
      <td>&lt;1H OCEAN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we drop all missing values</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>cali <span class="op">=</span> cali.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-for-extreme-values" class="level2">
<h2 class="anchored" data-anchor-id="check-for-extreme-values">Check for extreme values</h2>
<section id="outlier-detection" class="level3">
<h3 class="anchored" data-anchor-id="outlier-detection">outlier detection</h3>
<p>Note that extreme value detection and removal only applies to numerical features. To do it we first plot a boxplot of some feature, if we notice it has outliers we run the outlier removal function</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>cali.boxplot([<span class="st">"total_rooms"</span>, <span class="st">"total_bedrooms"</span>, <span class="st">"population"</span>, <span class="st">"households"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="eda_files/figure-html/cell-21-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span>cali[<span class="st">"median_income"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>&lt;AxesSubplot:xlabel='median_income'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="eda_files/figure-html/cell-22-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="outlier-removal" class="level3">
<h3 class="anchored" data-anchor-id="outlier-removal">outlier removal</h3>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> [<span class="st">'median_income'</span>]:</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    q75,q25 <span class="op">=</span> np.percentile(cali.loc[:,x],[<span class="dv">75</span>,<span class="dv">25</span>])</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    intr_qr <span class="op">=</span> q75<span class="op">-</span>q25</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">max</span> <span class="op">=</span> q75<span class="op">+</span>(<span class="fl">1.5</span><span class="op">*</span>intr_qr)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">min</span> <span class="op">=</span> q25<span class="op">-</span>(<span class="fl">1.5</span><span class="op">*</span>intr_qr)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    cali.loc[cali[x] <span class="op">&lt;</span> <span class="bu">min</span>,x] <span class="op">=</span> np.nan</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    cali.loc[cali[x] <span class="op">&gt;</span> <span class="bu">max</span>,x] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> [<span class="st">"total_rooms"</span>]:</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    q75,q25 <span class="op">=</span> np.percentile(cali.loc[:,x],[<span class="dv">75</span>,<span class="dv">25</span>])</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    intr_qr <span class="op">=</span> q75<span class="op">-</span>q25</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">max</span> <span class="op">=</span> q75<span class="op">+</span>(<span class="fl">1.5</span><span class="op">*</span>intr_qr)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">min</span> <span class="op">=</span> q25<span class="op">-</span>(<span class="fl">1.5</span><span class="op">*</span>intr_qr)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    cali.loc[cali[x] <span class="op">&lt;</span> <span class="bu">min</span>,x] <span class="op">=</span> np.nan</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    cali.loc[cali[x] <span class="op">&gt;</span> <span class="bu">max</span>,x] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> [<span class="st">"total_bedrooms"</span>]:</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    q75,q25 <span class="op">=</span> np.percentile(cali.loc[:,x],[<span class="dv">75</span>,<span class="dv">25</span>])</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    intr_qr <span class="op">=</span> q75<span class="op">-</span>q25</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">max</span> <span class="op">=</span> q75<span class="op">+</span>(<span class="fl">1.5</span><span class="op">*</span>intr_qr)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">min</span> <span class="op">=</span> q25<span class="op">-</span>(<span class="fl">1.5</span><span class="op">*</span>intr_qr)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    cali.loc[cali[x] <span class="op">&lt;</span> <span class="bu">min</span>,x] <span class="op">=</span> np.nan</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    cali.loc[cali[x] <span class="op">&gt;</span> <span class="bu">max</span>,x] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> [<span class="st">"population"</span>]:</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    q75,q25 <span class="op">=</span> np.percentile(cali.loc[:,x],[<span class="dv">75</span>,<span class="dv">25</span>])</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    intr_qr <span class="op">=</span> q75<span class="op">-</span>q25</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">max</span> <span class="op">=</span> q75<span class="op">+</span>(<span class="fl">1.5</span><span class="op">*</span>intr_qr)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">min</span> <span class="op">=</span> q25<span class="op">-</span>(<span class="fl">1.5</span><span class="op">*</span>intr_qr)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    cali.loc[cali[x] <span class="op">&lt;</span> <span class="bu">min</span>,x] <span class="op">=</span> np.nan</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    cali.loc[cali[x] <span class="op">&gt;</span> <span class="bu">max</span>,x] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> [<span class="st">"households"</span>]:</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    q75,q25 <span class="op">=</span> np.percentile(cali.loc[:,x],[<span class="dv">75</span>,<span class="dv">25</span>])</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    intr_qr <span class="op">=</span> q75<span class="op">-</span>q25</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">max</span> <span class="op">=</span> q75<span class="op">+</span>(<span class="fl">1.5</span><span class="op">*</span>intr_qr)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">min</span> <span class="op">=</span> q25<span class="op">-</span>(<span class="fl">1.5</span><span class="op">*</span>intr_qr)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    cali.loc[cali[x] <span class="op">&lt;</span> <span class="bu">min</span>,x] <span class="op">=</span> np.nan</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    cali.loc[cali[x] <span class="op">&gt;</span> <span class="bu">max</span>,x] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># null values increase since we replaced outliers with NAs</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>cali.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>longitude                0
latitude                 0
housing_median_age       0
total_rooms           1290
total_bedrooms        1271
population            1190
households            1210
median_income          670
median_house_value       0
ocean_proximity          0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now we drop them</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>cali <span class="op">=</span> cali.dropna(axis <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot after dropping extreme values</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>cali.boxplot([<span class="st">"total_rooms"</span>, <span class="st">"total_bedrooms"</span>, <span class="st">"population"</span>, <span class="st">"households"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="eda_files/figure-html/cell-30-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="check-for-skewness" class="level2">
<h2 class="anchored" data-anchor-id="check-for-skewness">Check for skewness</h2>
<p>from the following plot we can see there is right skew for the features which we’ll then perform log transformation on - total_rooms - total_bedrooms - population - households - median_income</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(cali, plot_kws<span class="op">=</span><span class="bu">dict</span>())<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="eda_files/figure-html/cell-31-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># log transformation</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>cali[<span class="st">'total_rooms'</span>]<span class="op">=</span> np.sqrt(cali.total_rooms)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>cali[<span class="st">'total_bedrooms'</span>]<span class="op">=</span> np.sqrt(cali.total_bedrooms)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>cali[<span class="st">'population'</span>]<span class="op">=</span> np.sqrt(cali.population)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>cali[<span class="st">'households'</span>]<span class="op">=</span> np.sqrt(cali.households)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>cali[<span class="st">'median_house_value'</span>]<span class="op">=</span> np.sqrt(cali.median_house_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>cali.hist(bins <span class="op">=</span> <span class="dv">30</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">15</span>), color <span class="op">=</span> <span class="st">'#005b96'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="eda_files/figure-html/cell-33-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> cali.drop(<span class="st">"median_house_value"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> pd.get_dummies(data<span class="op">=</span>features ,drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> cali[<span class="st">"median_house_value"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sm.OLS(target,features)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>fit <span class="op">=</span> model.fit()</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>fit.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>    <td>median_house_value</td> <th>  R-squared (uncentered):</th>       <td>   0.976</td>  
</tr>
<tr>
  <th>Model:</th>                    <td>OLS</td>        <th>  Adj. R-squared (uncentered):</th>  <td>   0.976</td>  
</tr>
<tr>
  <th>Method:</th>              <td>Least Squares</td>   <th>  F-statistic:       </th>           <td>7.407e+04</td> 
</tr>
<tr>
  <th>Date:</th>              <td>Tue, 29 Nov 2022</td>  <th>  Prob (F-statistic):</th>            <td>  0.00</td>   
</tr>
<tr>
  <th>Time:</th>                  <td>03:13:14</td>      <th>  Log-Likelihood:    </th>          <td>-1.0154e+05</td>
</tr>
<tr>
  <th>No. Observations:</th>       <td> 17994</td>       <th>  AIC:               </th>           <td>2.031e+05</td> 
</tr>
<tr>
  <th>Df Residuals:</th>           <td> 17984</td>       <th>  BIC:               </th>           <td>2.032e+05</td> 
</tr>
<tr>
  <th>Df Model:</th>               <td>    10</td>       <th>                     </th>               <td> </td>     
</tr>
<tr>
  <th>Covariance Type:</th>       <td>nonrobust</td>     <th>                     </th>               <td> </td>     
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
             <td></td>               <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>longitude</th>              <td>   -3.3673</td> <td>    0.120</td> <td>  -28.146</td> <td> 0.000</td> <td>   -3.602</td> <td>   -3.133</td>
</tr>
<tr>
  <th>latitude</th>               <td>   -5.2688</td> <td>    0.379</td> <td>  -13.919</td> <td> 0.000</td> <td>   -6.011</td> <td>   -4.527</td>
</tr>
<tr>
  <th>housing_median_age</th>     <td>    1.1075</td> <td>    0.046</td> <td>   24.174</td> <td> 0.000</td> <td>    1.018</td> <td>    1.197</td>
</tr>
<tr>
  <th>total_rooms</th>            <td>   -3.1268</td> <td>    0.160</td> <td>  -19.543</td> <td> 0.000</td> <td>   -3.440</td> <td>   -2.813</td>
</tr>
<tr>
  <th>total_bedrooms</th>         <td>   10.8581</td> <td>    0.496</td> <td>   21.877</td> <td> 0.000</td> <td>    9.885</td> <td>   11.831</td>
</tr>
<tr>
  <th>population</th>             <td>   -6.0049</td> <td>    0.131</td> <td>  -45.956</td> <td> 0.000</td> <td>   -6.261</td> <td>   -5.749</td>
</tr>
<tr>
  <th>households</th>             <td>    6.6374</td> <td>    0.489</td> <td>   13.576</td> <td> 0.000</td> <td>    5.679</td> <td>    7.596</td>
</tr>
<tr>
  <th>median_income</th>          <td>   52.4915</td> <td>    0.557</td> <td>   94.238</td> <td> 0.000</td> <td>   51.400</td> <td>   53.583</td>
</tr>
<tr>
  <th>ocean_proximity_INLAND</th> <td>  -73.1113</td> <td>    1.525</td> <td>  -47.933</td> <td> 0.000</td> <td>  -76.101</td> <td>  -70.122</td>
</tr>
<tr>
  <th>ocean_proximity_OTHER</th>  <td>    2.1711</td> <td>    1.381</td> <td>    1.572</td> <td> 0.116</td> <td>   -0.536</td> <td>    4.878</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
  <th>Omnibus:</th>       <td>2366.622</td> <th>  Durbin-Watson:     </th> <td>   1.027</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th>  <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>6171.857</td>
</tr>
<tr>
  <th>Skew:</th>           <td> 0.740</td>  <th>  Prob(JB):          </th> <td>    0.00</td>
</tr>
<tr>
  <th>Kurtosis:</th>       <td> 5.458</td>  <th>  Cond. No.          </th> <td>    493.</td>
</tr>
</tbody></table><br><br>Notes:<br>[1] R² is computed without centering (uncentered) since the model does not contain a constant.<br>[2] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
</section>
<section id="check-for-redundant-features" class="level2">
<h2 class="anchored" data-anchor-id="check-for-redundant-features">Check for redundant features</h2>
<p>perform ANOVA test</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>cali <span class="op">=</span> pd.get_dummies(data<span class="op">=</span>cali,drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># divide features and target</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> cali.drop([<span class="st">'median_house_value'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> cali[<span class="st">"median_house_value"</span>]</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># anova test</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>anova_test <span class="op">=</span> SelectKBest(f_regression, k<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>anova_test.fit(features, target)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># show results                    </span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> anova_test.get_support(indices<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(cali.columns[i])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>latitude
housing_median_age
total_rooms
median_income
median_house_value
ocean_proximity_INLAND</code></pre>
</div>
</div>
<p>Mutual information</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>mutual_information <span class="op">=</span> SelectKBest(mutual_info_regression, k<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>mutual_information.fit(features, target)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> mutual_information.get_support(indices<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(cali.columns[i])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>longitude
latitude
housing_median_age
median_income
median_house_value
ocean_proximity_INLAND</code></pre>
</div>
</div>
</section>
<section id="dimension-reduction" class="level2">
<h2 class="anchored" data-anchor-id="dimension-reduction">Dimension reduction</h2>
<p>Using PCA</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="fl">0.99</span>, svd_solver<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>pca.fit(features)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>PCA(copy<span class="op">=</span><span class="va">True</span>, iterated_power<span class="op">=</span><span class="st">'auto'</span>, n_components<span class="op">=</span><span class="fl">0.99</span>, random_state<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    svd_solver<span class="op">=</span><span class="st">'auto'</span>, tol<span class="op">=</span><span class="fl">0.0</span>, whiten<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>PCA(n_components=0.99)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">PCA</label><div class="sk-toggleable__content"><pre>PCA(n_components=0.99)</pre></div></div></div></div></div>
</div>
</div>
</section>
<section id="dummy-encoding" class="level2">
<h2 class="anchored" data-anchor-id="dummy-encoding">Dummy encoding</h2>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># encode categorical variables as numeric using dummy encoding</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>cali <span class="op">=</span> pd.get_dummies(data<span class="op">=</span>cali,drop_first<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>cali</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>housing_median_age</th>
      <th>total_rooms</th>
      <th>total_bedrooms</th>
      <th>population</th>
      <th>households</th>
      <th>median_income</th>
      <th>median_house_value</th>
      <th>ocean_proximity_INLAND</th>
      <th>ocean_proximity_OTHER</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>-122.24</td>
      <td>37.85</td>
      <td>52.0</td>
      <td>38.301436</td>
      <td>13.784049</td>
      <td>22.271057</td>
      <td>13.304135</td>
      <td>7.2574</td>
      <td>593.380148</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-122.25</td>
      <td>37.85</td>
      <td>52.0</td>
      <td>35.693137</td>
      <td>15.329710</td>
      <td>23.622024</td>
      <td>14.798649</td>
      <td>5.6431</td>
      <td>584.208867</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-122.25</td>
      <td>37.85</td>
      <td>52.0</td>
      <td>40.336088</td>
      <td>16.733201</td>
      <td>23.769729</td>
      <td>16.093477</td>
      <td>3.8462</td>
      <td>584.978632</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-122.25</td>
      <td>37.85</td>
      <td>52.0</td>
      <td>30.315013</td>
      <td>14.594520</td>
      <td>20.322401</td>
      <td>13.892444</td>
      <td>4.0368</td>
      <td>519.326487</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-122.25</td>
      <td>37.84</td>
      <td>52.0</td>
      <td>50.348784</td>
      <td>22.113344</td>
      <td>33.075671</td>
      <td>22.671568</td>
      <td>3.6591</td>
      <td>546.991773</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>20635</th>
      <td>-121.09</td>
      <td>39.48</td>
      <td>25.0</td>
      <td>40.804412</td>
      <td>19.339080</td>
      <td>29.068884</td>
      <td>18.165902</td>
      <td>1.5603</td>
      <td>279.463772</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>20636</th>
      <td>-121.21</td>
      <td>39.49</td>
      <td>18.0</td>
      <td>26.400758</td>
      <td>12.247449</td>
      <td>18.867962</td>
      <td>10.677078</td>
      <td>2.5568</td>
      <td>277.668868</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>20637</th>
      <td>-121.22</td>
      <td>39.43</td>
      <td>17.0</td>
      <td>47.476310</td>
      <td>22.022716</td>
      <td>31.733263</td>
      <td>20.808652</td>
      <td>1.7000</td>
      <td>303.809151</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>20638</th>
      <td>-121.32</td>
      <td>39.43</td>
      <td>18.0</td>
      <td>43.127717</td>
      <td>20.223748</td>
      <td>27.221315</td>
      <td>18.681542</td>
      <td>1.8672</td>
      <td>291.032644</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>20639</th>
      <td>-121.24</td>
      <td>39.37</td>
      <td>16.0</td>
      <td>52.773099</td>
      <td>24.819347</td>
      <td>37.242449</td>
      <td>23.021729</td>
      <td>2.3886</td>
      <td>298.998328</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>17994 rows × 11 columns</p>
</div>
</div>
</div>
<p>Save cleaned Data</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>cali.to_pickle(<span class="st">"../data/main_data.pkl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>